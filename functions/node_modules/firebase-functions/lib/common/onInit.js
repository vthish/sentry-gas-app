const require_logger_index = require('../logger/index.js');


let initCallback = null;
let didInit = false;

function onInit(callback) {
	if (initCallback) {
		require_logger_index.warn("Setting onInit callback more than once. Only the most recent callback will be called");
	}
	initCallback = callback;
	didInit = false;
}

function withInit(func) {
	return async (...args) => {
		if (!didInit) {
			if (initCallback) {
				await initCallback();
			}
			didInit = true;
		}
		return func(...args);
	};
}


exports.onInit = onInit;
exports.withInit = withInit;
