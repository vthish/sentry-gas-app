"use strict";













Object.defineProperty(exports, "__esModule", { value: true });
exports.HmacKey = void 0;
const index_js_1 = require("./nodejs-common/index.js");
const storage_js_1 = require("./storage.js");
const promisify_1 = require("@google-cloud/promisify");


class HmacKey extends index_js_1.ServiceObject {
    
    
    constructor(storage, accessId, options) {
        const methods = {
            
            
            
            
            delete: true,
            
            
            
            
            get: true,
            
            
            getMetadata: true,
            
            
            
            
            
            setMetadata: {
                reqOpts: {
                    method: 'PUT',
                },
            },
        };
        const projectId = (options && options.projectId) || storage.projectId;
        super({
            parent: storage,
            id: accessId,
            baseUrl: `/projects/${projectId}/hmacKeys`,
            methods,
        });
        this.storage = storage;
        this.instanceRetryValue = storage.retryOptions.autoRetry;
    }
    setMetadata(metadata, optionsOrCallback, cb) {

        if (this.storage.retryOptions.idempotencyStrategy !==
            storage_js_1.IdempotencyStrategy.RetryAlways) {
            this.storage.retryOptions.autoRetry = false;
        }
        const options = typeof optionsOrCallback === 'object' ? optionsOrCallback : {};
        cb =
            typeof optionsOrCallback === 'function'
                ? optionsOrCallback
                : cb;
        super
            .setMetadata(metadata, options)
            .then(resp => cb(null, ...resp))
            .catch(cb)
            .finally(() => {
            this.storage.retryOptions.autoRetry = this.instanceRetryValue;
        });
    }
}
exports.HmacKey = HmacKey;

(0, promisify_1.promisifyAll)(HmacKey);

