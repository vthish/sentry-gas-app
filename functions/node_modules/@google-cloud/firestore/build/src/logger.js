"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
exports.logger = logger;
exports.setLogFunction = setLogFunction;
exports.setLibVersion = setLibVersion;
const util = require("util");
const validate_1 = require("./validate");

let libVersion;

let logFunction = null;

function logger(methodName, requestTag, logMessage, ...additionalArgs) {
    requestTag = requestTag || '#####';
    if (logFunction) {
        const formattedMessage = util.format(logMessage, ...additionalArgs);
        const time = new Date().toISOString();
        logFunction(`Firestore (${libVersion}) ${time} ${requestTag} [${methodName}]: ` +
            formattedMessage);
    }
}

function setLogFunction(logger) {
    if (logger !== null)
        (0, validate_1.validateFunction)('logger', logger);
    logFunction = logger;
}

function setLibVersion(version) {
    libVersion = version;
}

